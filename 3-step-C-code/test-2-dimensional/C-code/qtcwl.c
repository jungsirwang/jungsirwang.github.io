//extern double d[30];
extern double coorr[90];
void dcoor(double (*shap)(double *,int),
           double *,double *,double *,int,int,int);
void q4(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    double rx,ry;
    double x[5],y[5];
    int j;
    for (j=1; j<=4; ++j)
    {
        x[j]=coorr[(1-1)*4+j-1];
        y[j]=coorr[(2-1)*4+j-1];
    }
    rx=refc[1];
    ry=refc[2];

    coor[1]=+(+(+1.-rx)/2.*(+1.-ry)/2.)*x[1]+(+(+1.+rx)/
            2.*(+1.-ry)/2.)*x[2]+(+(+1.+rx)/2.*(+1.+ry)/2.)*x[3]+(+
                    (+1.-rx)/2.*(+1.+ry)/2.)*x[4];

    coor[2]=+(+(+1.-rx)/2.*(+1.-ry)/2.)*y[1]+(+(+1.+rx)/
            2.*(+1.-ry)/2.)*y[2]+(+(+1.+rx)/2.*(+1.+ry)/2.)*y[3]+(+
                    (+1.-rx)/2.*(+1.+ry)/2.)*y[4];

    rc[0]=+(+(-1.)/2.*(+1.-ry)/2.)*x[1]+(+(+1.)/2.*(+
                                         1.-ry)/2.)*x[2]+(+(+1.)/2.*(+1.+ry)/2.)*x[3]+(+(-1.)/
                                                 2.*(+1.+ry)/2.)*x[4];

    rc[2]=+(+(-1.)/2.*(+1.-ry)/2.)*y[1]+(+(+1.)/2.*(+
                                         1.-ry)/2.)*y[2]+(+(+1.)/2.*(+1.+ry)/2.)*y[3]+(+(-1.)/
                                                 2.*(+1.+ry)/2.)*y[4];

    rc[1]=+(+(+1.-rx)/2.*(-1.)/2.)*x[1]+(+(+1.+rx)/2.*
                                         (-1.)/2.)*x[2]+(+(+1.+rx)/2.*(+1.)/2.)*x[3]+(+(+1.-rx)/
                                                 2.*(+1.)/2.)*x[4];

    rc[3]=+(+(+1.-rx)/2.*(-1.)/2.)*y[1]+(+(+1.+rx)/2.*
                                         (-1.)/2.)*y[2]+(+(+1.+rx)/2.*(+1.)/2.)*y[3]+(+(+1.-rx)/
                                                 2.*(+1.)/2.)*y[4];

    return;
}

void t3(double *refc,double *coor,double *rc)
{
    double rx,ry;
    double x[4],y[4];
    int j;
    for (j=1; j<=3; ++j)
    {
        x[j]=coorr[(1-1)*3+j-1];
        y[j]=coorr[(2-1)*3+j-1];
    }
    rx=refc[1];
    ry=refc[2];

    coor[1]=rx*x[1]+ry*x[2]+(1.-rx-ry)*x[3];
    coor[2]=rx*y[1]+ry*y[2]+(1.-rx-ry)*y[3];

    rc[0]=x[1]-x[3];
    rc[2]=y[1]-y[3];
    rc[1]=x[2]-x[3];
    rc[3]=y[2]-y[3];

    return;
}

void t6(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double ft6(double *,int);
    double (*shap)(double *,int)=&ft6;
    dcoor(shap,refc,coor,rc,2,2,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double ft6(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,ry,fval;
    double x[7],y[7];
    int j;
    for (j=1; j<=6; ++j)
    {
        x[j]=coorr[(1-1)*6+j-1];
        y[j]=coorr[(2-1)*6+j-1];
    }
    rx=refc[1];
    ry=refc[2];
    switch (n)
    {
    case 1:
        fval=
            +(+rx*(+2.*rx-1.))*x[1]+(+rx*ry*4.)*x[4]+(+
                    ry*(+2.*ry-1.))*x[2]+(+ry*(+1.-rx-ry)*4.)*x[5]+(+(+1.-
                            2.*rx-2.*ry)*(+1.-rx-ry))*x[3]+(+rx*(+1.-rx-ry)*4.)*x[6];
        break;
    case 2:
        fval=
            +(+rx*(+2.*rx-1.))*y[1]+(+rx*ry*4.)*y[4]+(+
                    ry*(+2.*ry-1.))*y[2]+(+ry*(+1.-rx-ry)*4.)*y[5]+(+(+1.-
                            2.*rx-2.*ry)*(+1.-rx-ry))*y[3]+(+rx*(+1.-rx-ry)*4.)*y[6];
        break;
        //default:
    }
    return fval;
}

void q9(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    double rx,ry;
    double x[10],y[10];
    int j;
    for (j=1; j<=9; ++j)
    {
        x[j]=coorr[(1-1)*9+j-1];
        y[j]=coorr[(2-1)*9+j-1];
    }

    rx=refc[1];
    ry=refc[2];

    coor[1]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.)*x[1]+(+(+
            1.-rx*rx)*ry*(+ry-1.)/2.)*x[5]+(+rx*(+1.+rx)/2.*ry*(+
                                            ry-1.)/2.)*x[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry))*x[8]+(+
                                                    (+1.-rx*rx)*(+1.-ry*ry))*x[9]+(+rx*(+1.+rx)/2.*(+1.-
                                                            ry*ry))*x[6]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.)*x[4]+(+
                                                                    (+1.-rx*rx)*ry*(+1.+ry)/2.)*x[7]+(+rx*(+1.+rx)/2.*ry*
                                                                            (+1.+ry)/2.)*x[3];

    coor[2]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.)*y[1]+(+(+
            1.-rx*rx)*ry*(+ry-1.)/2.)*y[5]+(+rx*(+1.+rx)/2.*ry*(+
                                            ry-1.)/2.)*y[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry))*y[8]+(+
                                                    (+1.-rx*rx)*(+1.-ry*ry))*y[9]+(+rx*(+1.+rx)/2.*(+1.-
                                                            ry*ry))*y[6]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.)*y[4]+(+
                                                                    (+1.-rx*rx)*ry*(+1.+ry)/2.)*y[7]+(+rx*(+1.+rx)/2.*ry*
                                                                            (+1.+ry)/2.)*y[3];

    rc[0]=+(+(+rx-1.)/2.*ry*(+ry-1.)/2.+rx*(+1.)/2.*
            ry*(+ry-1.)/2.)*x[1]+(+(-2.*rx)*ry*(+ry-1.)/2.)*x[5]+(+
                    (+1.+rx)/2.*ry*(+ry-1.)/2.+rx*(+1.)/2.*ry*(+ry-1.)/
                    2.)*x[2]+(+(+rx-1.)/2.*(+1.-ry*ry)+rx*(+1.)/2.*(+1.-
                              ry*ry))*x[8]+(+(-2.*rx)*(+1.-ry*ry))*x[9]+(+(+1.+rx)/
                                      2.*(+1.-ry*ry)+rx*(+1.)/2.*(+1.-ry*ry))*x[6]+(+(+rx-
                                              1.)/2.*ry*(+1.+ry)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.)*x[4]
          +(+(-2.*rx)*ry*(+1.+ry)/2.)*x[7]+(+(+1.+rx)/2.*ry*(+
                                            1.+ry)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.)*x[3];

    rc[2]=+(+(+rx-1.)/2.*ry*(+ry-1.)/2.+rx*(+1.)/2.*
            ry*(+ry-1.)/2.)*y[1]+(+(-2.*rx)*ry*(+ry-1.)/2.)*y[5]+(+
                    (+1.+rx)/2.*ry*(+ry-1.)/2.+rx*(+1.)/2.*ry*(+ry-1.)/
                    2.)*y[2]+(+(+rx-1.)/2.*(+1.-ry*ry)+rx*(+1.)/2.*(+1.-
                              ry*ry))*y[8]+(+(-2.*rx)*(+1.-ry*ry))*y[9]+(+(+1.+rx)/
                                      2.*(+1.-ry*ry)+rx*(+1.)/2.*(+1.-ry*ry))*y[6]+(+(+rx-
                                              1.)/2.*ry*(+1.+ry)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.)*y[4]
          +(+(-2.*rx)*ry*(+1.+ry)/2.)*y[7]+(+(+1.+rx)/2.*ry*(+
                                            1.+ry)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.)*y[3];

    rc[1]=+(+rx*(+rx-1.)/2.*(+ry-1.)/2.+rx*(+rx-1.)/
            2.*ry*(+1.)/2.)*x[1]+(+(+1.-rx*rx)*(+ry-1.)/2.+(+1.-
                                  rx*rx)*ry*(+1.)/2.)*x[5]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.+
                                          rx*(+1.+rx)/2.*ry*(+1.)/2.)*x[2]+(+rx*(+rx-1.)/2.*(-
                                                  2.*ry))*x[8]+(+(+1.-rx*rx)*(-2.*ry))*x[9]+(+rx*(+1.+rx)/
                                                          2.*(-2.*ry))*x[6]+(+rx*(+rx-1.)/2.*(+1.+ry)/2.+rx*(+
                                                                  rx-1.)/2.*ry*(+1.)/2.)*x[4]+(+(+1.-rx*rx)*(+1.+ry)/2.+
                                                                          (+1.-rx*rx)*ry*(+1.)/2.)*x[7]+(+rx*(+1.+rx)/2.*(+1.+
                                                                                  ry)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.)*x[3];

    rc[3]=+(+rx*(+rx-1.)/2.*(+ry-1.)/2.+rx*(+rx-1.)/
            2.*ry*(+1.)/2.)*y[1]+(+(+1.-rx*rx)*(+ry-1.)/2.+(+1.-
                                  rx*rx)*ry*(+1.)/2.)*y[5]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.+
                                          rx*(+1.+rx)/2.*ry*(+1.)/2.)*y[2]+(+rx*(+rx-1.)/2.*(-
                                                  2.*ry))*y[8]+(+(+1.-rx*rx)*(-2.*ry))*y[9]+(+rx*(+1.+rx)/
                                                          2.*(-2.*ry))*y[6]+(+rx*(+rx-1.)/2.*(+1.+ry)/2.+rx*(+
                                                                  rx-1.)/2.*ry*(+1.)/2.)*y[4]+(+(+1.-rx*rx)*(+1.+ry)/2.+
                                                                          (+1.-rx*rx)*ry*(+1.)/2.)*y[7]+(+rx*(+1.+rx)/2.*(+1.+
                                                                                  ry)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.)*y[3];

    return;
}

void c8(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double fc8(double *,int);
    double (*shap)(double *,int)=&fc8;
    dcoor(shap,refc,coor,rc,3,3,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double fc8(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,ry,rz,fval;
    double x[9],y[9],z[9];
    int j;
    for (j=1; j<=8; ++j)
    {
        x[j]=coorr[(1-1)*8+j-1];
        y[j]=coorr[(2-1)*8+j-1];
        z[j]=coorr[(3-1)*8+j-1];
    }
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    switch (n)
    {
    case 1:
        fval=
            +(+(+1.-rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.)*x[1]
            +(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.)*x[2]+(+(+1.+
                    rx)/2.*(+1.+ry)/2.*(+1.-rz)/2.)*x[3]+(+(+1.-rx)/2.*(+
                            1.+ry)/2.*(+1.-rz)/2.)*x[4]+(+(+1.-rx)/2.*(+1.-ry)/2.*
                                    (+1.+rz)/2.)*x[5]+(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.+rz)/
                                            2.)*x[6]+(+(+1.+rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.)*x[7]+(+
                                                    (+1.-rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.)*x[8];
        break;
    case 2:
        fval=
            +(+(+1.-rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.)*y[1]
            +(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.)*y[2]+(+(+1.+
                    rx)/2.*(+1.+ry)/2.*(+1.-rz)/2.)*y[3]+(+(+1.-rx)/2.*(+
                            1.+ry)/2.*(+1.-rz)/2.)*y[4]+(+(+1.-rx)/2.*(+1.-ry)/2.*
                                    (+1.+rz)/2.)*y[5]+(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.+rz)/
                                            2.)*y[6]+(+(+1.+rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.)*y[7]+(+
                                                    (+1.-rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.)*y[8];
        break;
    case 3:
        fval=
            +(+(+1.-rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.)*z[1]
            +(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.)*z[2]+(+(+1.+
                    rx)/2.*(+1.+ry)/2.*(+1.-rz)/2.)*z[3]+(+(+1.-rx)/2.*(+
                            1.+ry)/2.*(+1.-rz)/2.)*z[4]+(+(+1.-rx)/2.*(+1.-ry)/2.*
                                    (+1.+rz)/2.)*z[5]+(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.+rz)/
                                            2.)*z[6]+(+(+1.+rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.)*z[7]+(+
                                                    (+1.-rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.)*z[8];
        break;
        //default:
    }
    return fval;
}

void c27(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    double rx,ry,rz,fval;
    double x[28],y[28],z[28];
    int j;
    for (j=1; j<=27; ++j)
    {
        x[j]=coorr[(1-1)*27+j-1];
        y[j]=coorr[(2-1)*27+j-1];
        z[j]=coorr[(3-1)*27+j-1];
    }
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];

    coor[1]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-
              1.)/2.)*x[1]+(+(+1.-rx*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/
                            2.)*x[9]+(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/
                                      2.)*x[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*x[12]
            +(+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.)*x[21]+(+rx*
                    (+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*x[10]+(+rx*(+
                            rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*x[4]+(+(+1.-
                                    rx*rx)*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*x[11]+(+rx*(+1.+
                                            rx)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*x[3]+(+rx*(+rx-
                                                    1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz))*x[13]+(+(+1.-rx*rx)*
                                                            ry*(+ry-1.)/2.*(+1.-rz*rz))*x[22]+(+rx*(+1.+rx)/2.*ry*
                                                                    (+ry-1.)/2.*(+1.-rz*rz))*x[14]+(+rx*(+rx-1.)/2.*(+1.-
                                                                            ry*ry)*(+1.-rz*rz))*x[25]+(+(+1.-rx*rx)*(+1.-ry*ry)*(+
                                                                                    1.-rz*rz))*x[27]+(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.-rz*rz
                                                                                                                                  ))*x[23]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*x[16]
            +(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(+1.-rz*rz))*x[24]+(+rx*
                    (+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*x[15]+(+rx*(+
                            rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*x[5]+(+(+1.-
                                    rx*rx)*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*x[17]+(+rx*(+1.+
                                            rx)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*x[6]+(+rx*(+rx-
                                                    1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.)*x[20]+(+(+1.-rx*rx)*
                                                            (+1.-ry*ry)*rz*(+1.+rz)/2.)*x[26]+(+rx*(+1.+rx)/2.*(+
                                                                    1.-ry*ry)*rz*(+1.+rz)/2.)*x[18]+(+rx*(+rx-1.)/2.*ry*(+
                                                                            1.+ry)/2.*rz*(+1.+rz)/2.)*x[8]+(+(+1.-rx*rx)*ry*(+1.+
                                                                                    ry)/2.*rz*(+1.+rz)/2.)*x[19]+(+rx*(+1.+rx)/2.*ry*(+1.+
                                                                                            ry)/2.*rz*(+1.+rz)/2.)*x[7];

    coor[2]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-
              1.)/2.)*y[1]+(+(+1.-rx*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/
                            2.)*y[9]+(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/
                                      2.)*y[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*y[12]
            +(+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.)*y[21]+(+rx*
                    (+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*y[10]+(+rx*(+
                            rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*y[4]+(+(+1.-
                                    rx*rx)*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*y[11]+(+rx*(+1.+
                                            rx)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*y[3]+(+rx*(+rx-
                                                    1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz))*y[13]+(+(+1.-rx*rx)*
                                                            ry*(+ry-1.)/2.*(+1.-rz*rz))*y[22]+(+rx*(+1.+rx)/2.*ry*
                                                                    (+ry-1.)/2.*(+1.-rz*rz))*y[14]+(+rx*(+rx-1.)/2.*(+1.-
                                                                            ry*ry)*(+1.-rz*rz))*y[25]+(+(+1.-rx*rx)*(+1.-ry*ry)*(+
                                                                                    1.-rz*rz))*y[27]+(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.-rz*rz
                                                                                                                                  ))*y[23]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*y[16]
            +(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(+1.-rz*rz))*y[24]+(+rx*
                    (+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*y[15]+(+rx*(+
                            rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*y[5]+(+(+1.-
                                    rx*rx)*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*y[17]+(+rx*(+1.+
                                            rx)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*y[6]+(+rx*(+rx-
                                                    1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.)*y[20]+(+(+1.-rx*rx)*
                                                            (+1.-ry*ry)*rz*(+1.+rz)/2.)*y[26]+(+rx*(+1.+rx)/2.*(+
                                                                    1.-ry*ry)*rz*(+1.+rz)/2.)*y[18]+(+rx*(+rx-1.)/2.*ry*(+
                                                                            1.+ry)/2.*rz*(+1.+rz)/2.)*y[8]+(+(+1.-rx*rx)*ry*(+1.+
                                                                                    ry)/2.*rz*(+1.+rz)/2.)*y[19]+(+rx*(+1.+rx)/2.*ry*(+1.+
                                                                                            ry)/2.*rz*(+1.+rz)/2.)*y[7];

    coor[3]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-
              1.)/2.)*z[1]+(+(+1.-rx*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/
                            2.)*z[9]+(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/
                                      2.)*z[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*z[12]
            +(+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.)*z[21]+(+rx*
                    (+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*z[10]+(+rx*(+
                            rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*z[4]+(+(+1.-
                                    rx*rx)*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*z[11]+(+rx*(+1.+
                                            rx)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*z[3]+(+rx*(+rx-
                                                    1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz))*z[13]+(+(+1.-rx*rx)*
                                                            ry*(+ry-1.)/2.*(+1.-rz*rz))*z[22]+(+rx*(+1.+rx)/2.*ry*
                                                                    (+ry-1.)/2.*(+1.-rz*rz))*z[14]+(+rx*(+rx-1.)/2.*(+1.-
                                                                            ry*ry)*(+1.-rz*rz))*z[25]+(+(+1.-rx*rx)*(+1.-ry*ry)*(+
                                                                                    1.-rz*rz))*z[27]+(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.-rz*rz
                                                                                                                                  ))*z[23]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*z[16]
            +(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(+1.-rz*rz))*z[24]+(+rx*
                    (+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*z[15]+(+rx*(+
                            rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*z[5]+(+(+1.-
                                    rx*rx)*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*z[17]+(+rx*(+1.+
                                            rx)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*z[6]+(+rx*(+rx-
                                                    1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.)*z[20]+(+(+1.-rx*rx)*
                                                            (+1.-ry*ry)*rz*(+1.+rz)/2.)*z[26]+(+rx*(+1.+rx)/2.*(+
                                                                    1.-ry*ry)*rz*(+1.+rz)/2.)*z[18]+(+rx*(+rx-1.)/2.*ry*(+
                                                                            1.+ry)/2.*rz*(+1.+rz)/2.)*z[8]+(+(+1.-rx*rx)*ry*(+1.+
                                                                                    ry)/2.*rz*(+1.+rz)/2.)*z[19]+(+rx*(+1.+rx)/2.*ry*(+1.+
                                                                                            ry)/2.*rz*(+1.+rz)/2.)*z[7];

    rc[0]=+(+(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/
            2.+rx*(+1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.)*x[1]+(+
                    (-2.*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.)*x[9]+(+(+1.+
                            rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.+rx*(+1.)/2.*ry*
                            (+ry-1.)/2.*rz*(+rz-1.)/2.)*x[2]+(+(+rx-1.)/2.*(+1.-
                                    ry*ry)*rz*(+rz-1.)/2.+rx*(+1.)/2.*(+1.-ry*ry)*rz*(+
                                            rz-1.)/2.)*x[12]+(+(-2.*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.)*x[21]
          +(+(+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.+rx*(+1.)/
            2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*x[10]+(+(+rx-1.)/2.*ry*
                    (+1.+ry)/2.*rz*(+rz-1.)/2.+rx*(+1.)/2.*ry*(+1.+ry)/
                    2.*rz*(+rz-1.)/2.)*x[4]+(+(-2.*rx)*ry*(+1.+ry)/2.*rz*
                            (+rz-1.)/2.)*x[11]+(+(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+
                                    rz-1.)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*x[3]
          +(+(+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz)+rx*(+1.)/
            2.*ry*(+ry-1.)/2.*(+1.-rz*rz))*x[13]+(+(-2.*rx)*ry*(+
                    ry-1.)/2.*(+1.-rz*rz))*x[22]+(+(+1.+rx)/2.*ry*(+ry-1.)/
                            2.*(+1.-rz*rz)+rx*(+1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz
                                                                      ))*x[14]+(+(+rx-1.)/2.*(+1.-ry*ry)*(+1.-rz*rz)+rx*(+
                                                                              1.)/2.*(+1.-ry*ry)*(+1.-rz*rz))*x[25]+(+(-2.*rx)*(+1.-
                                                                                      ry*ry)*(+1.-rz*rz))*x[27]+(+(+1.+rx)/2.*(+1.-ry*ry)*(+
                                                                                              1.-rz*rz)+rx*(+1.)/2.*(+1.-ry*ry)*(+1.-rz*rz))*x[23]+(+
                                                                                                      (+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz)+rx*(+1.)/2.*
                                                                                                      ry*(+1.+ry)/2.*(+1.-rz*rz))*x[16]+(+(-2.*rx)*ry*(+1.+
                                                                                                              ry)/2.*(+1.-rz*rz))*x[24]+(+(+1.+rx)/2.*ry*(+1.+ry)/2.*
                                                                                                                      (+1.-rz*rz)+rx*(+1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*x[15]
          +(+(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+1.)/
            2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*x[5]+(+(-2.*rx)*ry*
                    (+ry-1.)/2.*rz*(+1.+rz)/2.)*x[17]+(+(+1.+rx)/2.*ry*(+
                            ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+1.)/2.*ry*(+ry-1.)/2.*
                            rz*(+1.+rz)/2.)*x[6]+(+(+rx-1.)/2.*(+1.-ry*ry)*rz*(+
                                    1.+rz)/2.+rx*(+1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.)*x[20]
          +(+(-2.*rx)*(+1.-ry*ry)*rz*(+1.+rz)/2.)*x[26]+(+(+1.+
                  rx)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.+rx*(+1.)/2.*(+1.-
                          ry*ry)*rz*(+1.+rz)/2.)*x[18]+(+(+rx-1.)/2.*ry*(+1.+ry)/
                                  2.*rz*(+1.+rz)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.*rz*(+1.+
                                          rz)/2.)*x[8]+(+(-2.*rx)*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.)*x[19]
          +(+(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+1.)/
            2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.)*x[7];

    rc[3]=+(+(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/
            2.+rx*(+1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.)*y[1]+(+
                    (-2.*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.)*y[9]+(+(+1.+
                            rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.+rx*(+1.)/2.*ry*
                            (+ry-1.)/2.*rz*(+rz-1.)/2.)*y[2]+(+(+rx-1.)/2.*(+1.-
                                    ry*ry)*rz*(+rz-1.)/2.+rx*(+1.)/2.*(+1.-ry*ry)*rz*(+
                                            rz-1.)/2.)*y[12]+(+(-2.*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.)*y[21]
          +(+(+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.+rx*(+1.)/
            2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*y[10]+(+(+rx-1.)/2.*ry*
                    (+1.+ry)/2.*rz*(+rz-1.)/2.+rx*(+1.)/2.*ry*(+1.+ry)/
                    2.*rz*(+rz-1.)/2.)*y[4]+(+(-2.*rx)*ry*(+1.+ry)/2.*rz*
                            (+rz-1.)/2.)*y[11]+(+(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+
                                    rz-1.)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*y[3]
          +(+(+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz)+rx*(+1.)/
            2.*ry*(+ry-1.)/2.*(+1.-rz*rz))*y[13]+(+(-2.*rx)*ry*(+
                    ry-1.)/2.*(+1.-rz*rz))*y[22]+(+(+1.+rx)/2.*ry*(+ry-1.)/
                            2.*(+1.-rz*rz)+rx*(+1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz
                                                                      ))*y[14]+(+(+rx-1.)/2.*(+1.-ry*ry)*(+1.-rz*rz)+rx*(+
                                                                              1.)/2.*(+1.-ry*ry)*(+1.-rz*rz))*y[25]+(+(-2.*rx)*(+1.-
                                                                                      ry*ry)*(+1.-rz*rz))*y[27]+(+(+1.+rx)/2.*(+1.-ry*ry)*(+
                                                                                              1.-rz*rz)+rx*(+1.)/2.*(+1.-ry*ry)*(+1.-rz*rz))*y[23]+(+
                                                                                                      (+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz)+rx*(+1.)/2.*
                                                                                                      ry*(+1.+ry)/2.*(+1.-rz*rz))*y[16]+(+(-2.*rx)*ry*(+1.+
                                                                                                              ry)/2.*(+1.-rz*rz))*y[24]+(+(+1.+rx)/2.*ry*(+1.+ry)/2.*
                                                                                                                      (+1.-rz*rz)+rx*(+1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*y[15]
          +(+(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+1.)/
            2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*y[5]+(+(-2.*rx)*ry*
                    (+ry-1.)/2.*rz*(+1.+rz)/2.)*y[17]+(+(+1.+rx)/2.*ry*(+
                            ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+1.)/2.*ry*(+ry-1.)/2.*
                            rz*(+1.+rz)/2.)*y[6]+(+(+rx-1.)/2.*(+1.-ry*ry)*rz*(+
                                    1.+rz)/2.+rx*(+1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.)*y[20]
          +(+(-2.*rx)*(+1.-ry*ry)*rz*(+1.+rz)/2.)*y[26]+(+(+1.+
                  rx)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.+rx*(+1.)/2.*(+1.-
                          ry*ry)*rz*(+1.+rz)/2.)*y[18]+(+(+rx-1.)/2.*ry*(+1.+ry)/
                                  2.*rz*(+1.+rz)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.*rz*(+1.+
                                          rz)/2.)*y[8]+(+(-2.*rx)*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.)*y[19]
          +(+(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+1.)/
            2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.)*y[7];

    rc[6]=+(+(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/
            2.+rx*(+1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.)*z[1]+(+
                    (-2.*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.)*z[9]+(+(+1.+
                            rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.+rx*(+1.)/2.*ry*
                            (+ry-1.)/2.*rz*(+rz-1.)/2.)*z[2]+(+(+rx-1.)/2.*(+1.-
                                    ry*ry)*rz*(+rz-1.)/2.+rx*(+1.)/2.*(+1.-ry*ry)*rz*(+
                                            rz-1.)/2.)*z[12]+(+(-2.*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.)*z[21]
          +(+(+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.+rx*(+1.)/
            2.*(+1.-ry*ry)*rz*(+rz-1.)/2.)*z[10]+(+(+rx-1.)/2.*ry*
                    (+1.+ry)/2.*rz*(+rz-1.)/2.+rx*(+1.)/2.*ry*(+1.+ry)/
                    2.*rz*(+rz-1.)/2.)*z[4]+(+(-2.*rx)*ry*(+1.+ry)/2.*rz*
                            (+rz-1.)/2.)*z[11]+(+(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+
                                    rz-1.)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.)*z[3]
          +(+(+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz)+rx*(+1.)/
            2.*ry*(+ry-1.)/2.*(+1.-rz*rz))*z[13]+(+(-2.*rx)*ry*(+
                    ry-1.)/2.*(+1.-rz*rz))*z[22]+(+(+1.+rx)/2.*ry*(+ry-1.)/
                            2.*(+1.-rz*rz)+rx*(+1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz
                                                                      ))*z[14]+(+(+rx-1.)/2.*(+1.-ry*ry)*(+1.-rz*rz)+rx*(+
                                                                              1.)/2.*(+1.-ry*ry)*(+1.-rz*rz))*z[25]+(+(-2.*rx)*(+1.-
                                                                                      ry*ry)*(+1.-rz*rz))*z[27]+(+(+1.+rx)/2.*(+1.-ry*ry)*(+
                                                                                              1.-rz*rz)+rx*(+1.)/2.*(+1.-ry*ry)*(+1.-rz*rz))*z[23]+(+
                                                                                                      (+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz)+rx*(+1.)/2.*
                                                                                                      ry*(+1.+ry)/2.*(+1.-rz*rz))*z[16]+(+(-2.*rx)*ry*(+1.+
                                                                                                              ry)/2.*(+1.-rz*rz))*z[24]+(+(+1.+rx)/2.*ry*(+1.+ry)/2.*
                                                                                                                      (+1.-rz*rz)+rx*(+1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz))*z[15]
          +(+(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+1.)/
            2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.)*z[5]+(+(-2.*rx)*ry*
                    (+ry-1.)/2.*rz*(+1.+rz)/2.)*z[17]+(+(+1.+rx)/2.*ry*(+
                            ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+1.)/2.*ry*(+ry-1.)/2.*
                            rz*(+1.+rz)/2.)*z[6]+(+(+rx-1.)/2.*(+1.-ry*ry)*rz*(+
                                    1.+rz)/2.+rx*(+1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.)*z[20]
          +(+(-2.*rx)*(+1.-ry*ry)*rz*(+1.+rz)/2.)*z[26]+(+(+1.+
                  rx)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.+rx*(+1.)/2.*(+1.-
                          ry*ry)*rz*(+1.+rz)/2.)*z[18]+(+(+rx-1.)/2.*ry*(+1.+ry)/
                                  2.*rz*(+1.+rz)/2.+rx*(+1.)/2.*ry*(+1.+ry)/2.*rz*(+1.+
                                          rz)/2.)*z[8]+(+(-2.*rx)*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.)*z[19]
          +(+(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+1.)/
            2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.)*z[7];

    rc[1]=+(+rx*(+rx-1.)/2.*(+ry-1.)/2.*rz*(+rz-1.)/
            2.+rx*(+rx-1.)/2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*x[1]+(+
                    (+1.-rx*rx)*(+ry-1.)/2.*rz*(+rz-1.)/2.+(+1.-rx*rx)*
                    ry*(+1.)/2.*rz*(+rz-1.)/2.)*x[9]+(+rx*(+1.+rx)/2.*(+
                            ry-1.)/2.*rz*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*
                            rz*(+rz-1.)/2.)*x[2]+(+rx*(+rx-1.)/2.*(-2.*ry)*rz*(+
                                    rz-1.)/2.)*x[12]+(+(+1.-rx*rx)*(-2.*ry)*rz*(+rz-1.)/2.)*x[21]
          +(+rx*(+1.+rx)/2.*(-2.*ry)*rz*(+rz-1.)/2.)*x[10]+(+rx*
                  (+rx-1.)/2.*(+1.+ry)/2.*rz*(+rz-1.)/2.+rx*(+rx-1.)/
                  2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*x[4]+(+(+1.-rx*rx)*(+
                          1.+ry)/2.*rz*(+rz-1.)/2.+(+1.-rx*rx)*ry*(+1.)/2.*rz*
                          (+rz-1.)/2.)*x[11]+(+rx*(+1.+rx)/2.*(+1.+ry)/2.*rz*(+
                                  rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*x[3]
          +(+rx*(+rx-1.)/2.*(+ry-1.)/2.*(+1.-rz*rz)+rx*(+rx-1.)/
            2.*ry*(+1.)/2.*(+1.-rz*rz))*x[13]+(+(+1.-rx*rx)*(+ry-
                    1.)/2.*(+1.-rz*rz)+(+1.-rx*rx)*ry*(+1.)/2.*(+1.-rz*rz
                                                               ))*x[22]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.*(+1.-rz*rz)+rx*
                                                                       (+1.+rx)/2.*ry*(+1.)/2.*(+1.-rz*rz))*x[14]+(+rx*(+rx-
                                                                               1.)/2.*(-2.*ry)*(+1.-rz*rz))*x[25]+(+(+1.-rx*rx)*(-2.*
                                                                                       ry)*(+1.-rz*rz))*x[27]+(+rx*(+1.+rx)/2.*(-2.*ry)*(+1.-
                                                                                               rz*rz))*x[23]+(+rx*(+rx-1.)/2.*(+1.+ry)/2.*(+1.-rz*rz)+
                                                                                                       rx*(+rx-1.)/2.*ry*(+1.)/2.*(+1.-rz*rz))*x[16]+(+(+1.-
                                                                                                               rx*rx)*(+1.+ry)/2.*(+1.-rz*rz)+(+1.-rx*rx)*ry*(+1.)/
                                                                                                               2.*(+1.-rz*rz))*x[24]+(+rx*(+1.+rx)/2.*(+1.+ry)/2.*(+
                                                                                                                       1.-rz*rz)+rx*(+1.+rx)/2.*ry*(+1.)/2.*(+1.-rz*rz))*x[15]
          +(+rx*(+rx-1.)/2.*(+ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+rx-
                  1.)/2.*ry*(+1.)/2.*rz*(+1.+rz)/2.)*x[5]+(+(+1.-rx*rx)*
                          (+ry-1.)/2.*rz*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.)/2.*
                          rz*(+1.+rz)/2.)*x[17]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.*rz*
                                  (+1.+rz)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*rz*(+1.+rz)/
                                  2.)*x[6]+(+rx*(+rx-1.)/2.*(-2.*ry)*rz*(+1.+rz)/2.)*x[20]
          +(+(+1.-rx*rx)*(-2.*ry)*rz*(+1.+rz)/2.)*x[26]+(+rx*(+
                  1.+rx)/2.*(-2.*ry)*rz*(+1.+rz)/2.)*x[18]+(+rx*(+rx-1.)/
                          2.*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+rx-1.)/2.*ry*(+1.)/
                          2.*rz*(+1.+rz)/2.)*x[8]+(+(+1.-rx*rx)*(+1.+ry)/2.*rz*
                                  (+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.)/2.*rz*(+1.+rz)/2.)*x[19]
          +(+rx*(+1.+rx)/2.*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+1.+
                  rx)/2.*ry*(+1.)/2.*rz*(+1.+rz)/2.)*x[7];

    rc[4]=+(+rx*(+rx-1.)/2.*(+ry-1.)/2.*rz*(+rz-1.)/
            2.+rx*(+rx-1.)/2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*y[1]+(+
                    (+1.-rx*rx)*(+ry-1.)/2.*rz*(+rz-1.)/2.+(+1.-rx*rx)*
                    ry*(+1.)/2.*rz*(+rz-1.)/2.)*y[9]+(+rx*(+1.+rx)/2.*(+
                            ry-1.)/2.*rz*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*
                            rz*(+rz-1.)/2.)*y[2]+(+rx*(+rx-1.)/2.*(-2.*ry)*rz*(+
                                    rz-1.)/2.)*y[12]+(+(+1.-rx*rx)*(-2.*ry)*rz*(+rz-1.)/2.)*y[21]
          +(+rx*(+1.+rx)/2.*(-2.*ry)*rz*(+rz-1.)/2.)*y[10]+(+rx*
                  (+rx-1.)/2.*(+1.+ry)/2.*rz*(+rz-1.)/2.+rx*(+rx-1.)/
                  2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*y[4]+(+(+1.-rx*rx)*(+
                          1.+ry)/2.*rz*(+rz-1.)/2.+(+1.-rx*rx)*ry*(+1.)/2.*rz*
                          (+rz-1.)/2.)*y[11]+(+rx*(+1.+rx)/2.*(+1.+ry)/2.*rz*(+
                                  rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*y[3]
          +(+rx*(+rx-1.)/2.*(+ry-1.)/2.*(+1.-rz*rz)+rx*(+rx-1.)/
            2.*ry*(+1.)/2.*(+1.-rz*rz))*y[13]+(+(+1.-rx*rx)*(+ry-
                    1.)/2.*(+1.-rz*rz)+(+1.-rx*rx)*ry*(+1.)/2.*(+1.-rz*rz
                                                               ))*y[22]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.*(+1.-rz*rz)+rx*
                                                                       (+1.+rx)/2.*ry*(+1.)/2.*(+1.-rz*rz))*y[14]+(+rx*(+rx-
                                                                               1.)/2.*(-2.*ry)*(+1.-rz*rz))*y[25]+(+(+1.-rx*rx)*(-2.*
                                                                                       ry)*(+1.-rz*rz))*y[27]+(+rx*(+1.+rx)/2.*(-2.*ry)*(+1.-
                                                                                               rz*rz))*y[23]+(+rx*(+rx-1.)/2.*(+1.+ry)/2.*(+1.-rz*rz)+
                                                                                                       rx*(+rx-1.)/2.*ry*(+1.)/2.*(+1.-rz*rz))*y[16]+(+(+1.-
                                                                                                               rx*rx)*(+1.+ry)/2.*(+1.-rz*rz)+(+1.-rx*rx)*ry*(+1.)/
                                                                                                               2.*(+1.-rz*rz))*y[24]+(+rx*(+1.+rx)/2.*(+1.+ry)/2.*(+
                                                                                                                       1.-rz*rz)+rx*(+1.+rx)/2.*ry*(+1.)/2.*(+1.-rz*rz))*y[15]
          +(+rx*(+rx-1.)/2.*(+ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+rx-
                  1.)/2.*ry*(+1.)/2.*rz*(+1.+rz)/2.)*y[5]+(+(+1.-rx*rx)*
                          (+ry-1.)/2.*rz*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.)/2.*
                          rz*(+1.+rz)/2.)*y[17]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.*rz*
                                  (+1.+rz)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*rz*(+1.+rz)/
                                  2.)*y[6]+(+rx*(+rx-1.)/2.*(-2.*ry)*rz*(+1.+rz)/2.)*y[20]
          +(+(+1.-rx*rx)*(-2.*ry)*rz*(+1.+rz)/2.)*y[26]+(+rx*(+
                  1.+rx)/2.*(-2.*ry)*rz*(+1.+rz)/2.)*y[18]+(+rx*(+rx-1.)/
                          2.*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+rx-1.)/2.*ry*(+1.)/
                          2.*rz*(+1.+rz)/2.)*y[8]+(+(+1.-rx*rx)*(+1.+ry)/2.*rz*
                                  (+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.)/2.*rz*(+1.+rz)/2.)*y[19]
          +(+rx*(+1.+rx)/2.*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+1.+
                  rx)/2.*ry*(+1.)/2.*rz*(+1.+rz)/2.)*y[7];

    rc[7]=+(+rx*(+rx-1.)/2.*(+ry-1.)/2.*rz*(+rz-1.)/
            2.+rx*(+rx-1.)/2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*z[1]+(+
                    (+1.-rx*rx)*(+ry-1.)/2.*rz*(+rz-1.)/2.+(+1.-rx*rx)*
                    ry*(+1.)/2.*rz*(+rz-1.)/2.)*z[9]+(+rx*(+1.+rx)/2.*(+
                            ry-1.)/2.*rz*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*
                            rz*(+rz-1.)/2.)*z[2]+(+rx*(+rx-1.)/2.*(-2.*ry)*rz*(+
                                    rz-1.)/2.)*z[12]+(+(+1.-rx*rx)*(-2.*ry)*rz*(+rz-1.)/2.)*z[21]
          +(+rx*(+1.+rx)/2.*(-2.*ry)*rz*(+rz-1.)/2.)*z[10]+(+rx*
                  (+rx-1.)/2.*(+1.+ry)/2.*rz*(+rz-1.)/2.+rx*(+rx-1.)/
                  2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*z[4]+(+(+1.-rx*rx)*(+
                          1.+ry)/2.*rz*(+rz-1.)/2.+(+1.-rx*rx)*ry*(+1.)/2.*rz*
                          (+rz-1.)/2.)*z[11]+(+rx*(+1.+rx)/2.*(+1.+ry)/2.*rz*(+
                                  rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*rz*(+rz-1.)/2.)*z[3]
          +(+rx*(+rx-1.)/2.*(+ry-1.)/2.*(+1.-rz*rz)+rx*(+rx-1.)/
            2.*ry*(+1.)/2.*(+1.-rz*rz))*z[13]+(+(+1.-rx*rx)*(+ry-
                    1.)/2.*(+1.-rz*rz)+(+1.-rx*rx)*ry*(+1.)/2.*(+1.-rz*rz
                                                               ))*z[22]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.*(+1.-rz*rz)+rx*
                                                                       (+1.+rx)/2.*ry*(+1.)/2.*(+1.-rz*rz))*z[14]+(+rx*(+rx-
                                                                               1.)/2.*(-2.*ry)*(+1.-rz*rz))*z[25]+(+(+1.-rx*rx)*(-2.*
                                                                                       ry)*(+1.-rz*rz))*z[27]+(+rx*(+1.+rx)/2.*(-2.*ry)*(+1.-
                                                                                               rz*rz))*z[23]+(+rx*(+rx-1.)/2.*(+1.+ry)/2.*(+1.-rz*rz)+
                                                                                                       rx*(+rx-1.)/2.*ry*(+1.)/2.*(+1.-rz*rz))*z[16]+(+(+1.-
                                                                                                               rx*rx)*(+1.+ry)/2.*(+1.-rz*rz)+(+1.-rx*rx)*ry*(+1.)/
                                                                                                               2.*(+1.-rz*rz))*z[24]+(+rx*(+1.+rx)/2.*(+1.+ry)/2.*(+
                                                                                                                       1.-rz*rz)+rx*(+1.+rx)/2.*ry*(+1.)/2.*(+1.-rz*rz))*z[15]
          +(+rx*(+rx-1.)/2.*(+ry-1.)/2.*rz*(+1.+rz)/2.+rx*(+rx-
                  1.)/2.*ry*(+1.)/2.*rz*(+1.+rz)/2.)*z[5]+(+(+1.-rx*rx)*
                          (+ry-1.)/2.*rz*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.)/2.*
                          rz*(+1.+rz)/2.)*z[17]+(+rx*(+1.+rx)/2.*(+ry-1.)/2.*rz*
                                  (+1.+rz)/2.+rx*(+1.+rx)/2.*ry*(+1.)/2.*rz*(+1.+rz)/
                                  2.)*z[6]+(+rx*(+rx-1.)/2.*(-2.*ry)*rz*(+1.+rz)/2.)*z[20]
          +(+(+1.-rx*rx)*(-2.*ry)*rz*(+1.+rz)/2.)*z[26]+(+rx*(+
                  1.+rx)/2.*(-2.*ry)*rz*(+1.+rz)/2.)*z[18]+(+rx*(+rx-1.)/
                          2.*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+rx-1.)/2.*ry*(+1.)/
                          2.*rz*(+1.+rz)/2.)*z[8]+(+(+1.-rx*rx)*(+1.+ry)/2.*rz*
                                  (+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.)/2.*rz*(+1.+rz)/2.)*z[19]
          +(+rx*(+1.+rx)/2.*(+1.+ry)/2.*rz*(+1.+rz)/2.+rx*(+1.+
                  rx)/2.*ry*(+1.)/2.*rz*(+1.+rz)/2.)*z[7];

    rc[2]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*(+rz-1.)/
            2.+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*x[1]+(+
                    (+1.-rx*rx)*ry*(+ry-1.)/2.*(+rz-1.)/2.+(+1.-rx*rx)*
                    ry*(+ry-1.)/2.*rz*(+1.)/2.)*x[9]+(+rx*(+1.+rx)/2.*ry*
                            (+ry-1.)/2.*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+ry-1.)/
                            2.*rz*(+1.)/2.)*x[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+
                                    rz-1.)/2.+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+1.)/2.)*x[12]
          +(+(+1.-rx*rx)*(+1.-ry*ry)*(+rz-1.)/2.+(+1.-rx*rx)*
            (+1.-ry*ry)*rz*(+1.)/2.)*x[21]+(+rx*(+1.+rx)/2.*(+1.-
                                            ry*ry)*(+rz-1.)/2.+rx*(+1.+rx)/2.*(+1.-ry*ry)*rz*(+
                                                    1.)/2.)*x[10]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+rz-1.)/
                                                            2.+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+1.)/2.)*x[4]+(+
                                                                    (+1.-rx*rx)*ry*(+1.+ry)/2.*(+rz-1.)/2.+(+1.-rx*rx)*
                                                                    ry*(+1.+ry)/2.*rz*(+1.)/2.)*x[11]+(+rx*(+1.+rx)/2.*ry*
                                                                            (+1.+ry)/2.*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.+ry)/
                                                                            2.*rz*(+1.)/2.)*x[3]+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*
                                                                                    (-2.*rz))*x[13]+(+(+1.-rx*rx)*ry*(+ry-1.)/2.*(-2.*rz))*x[22]
          +(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(-2.*rz))*x[14]+(+rx*
                  (+rx-1.)/2.*(+1.-ry*ry)*(-2.*rz))*x[25]+(+(+1.-rx*rx)*
                          (+1.-ry*ry)*(-2.*rz))*x[27]+(+rx*(+1.+rx)/2.*(+1.-ry*ry
                                                                       )*(-2.*rz))*x[23]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(-
                                                                               2.*rz))*x[16]+(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(-2.*rz))*x[24]
          +(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(-2.*rz))*x[15]+(+rx*
                  (+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.+rz)/2.+rx*(+rx-1.)/
                  2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*x[5]+(+(+1.-rx*rx)*ry*
                          (+ry-1.)/2.*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+ry-1.)/2.*
                          rz*(+1.)/2.)*x[17]+(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(+
                                  1.+rz)/2.+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*x[6]
          +(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+1.+rz)/2.+rx*(+rx-1.)/
            2.*(+1.-ry*ry)*rz*(+1.)/2.)*x[20]+(+(+1.-rx*rx)*(+1.-
                    ry*ry)*(+1.+rz)/2.+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+1.)/
                    2.)*x[26]+(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.+rz)/2.+rx*
                               (+1.+rx)/2.*(+1.-ry*ry)*rz*(+1.)/2.)*x[18]+(+rx*(+rx-
                                       1.)/2.*ry*(+1.+ry)/2.*(+1.+rz)/2.+rx*(+rx-1.)/2.*ry*
                                       (+1.+ry)/2.*rz*(+1.)/2.)*x[8]+(+(+1.-rx*rx)*ry*(+1.+
                                               ry)/2.*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.+ry)/2.*rz*(+
                                                       1.)/2.)*x[19]+(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.+rz)/
                                                               2.+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.)/2.)*x[7];

    rc[5]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*(+rz-1.)/
            2.+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*y[1]+(+
                    (+1.-rx*rx)*ry*(+ry-1.)/2.*(+rz-1.)/2.+(+1.-rx*rx)*
                    ry*(+ry-1.)/2.*rz*(+1.)/2.)*y[9]+(+rx*(+1.+rx)/2.*ry*
                            (+ry-1.)/2.*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+ry-1.)/
                            2.*rz*(+1.)/2.)*y[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+
                                    rz-1.)/2.+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+1.)/2.)*y[12]
          +(+(+1.-rx*rx)*(+1.-ry*ry)*(+rz-1.)/2.+(+1.-rx*rx)*
            (+1.-ry*ry)*rz*(+1.)/2.)*y[21]+(+rx*(+1.+rx)/2.*(+1.-
                                            ry*ry)*(+rz-1.)/2.+rx*(+1.+rx)/2.*(+1.-ry*ry)*rz*(+
                                                    1.)/2.)*y[10]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+rz-1.)/
                                                            2.+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+1.)/2.)*y[4]+(+
                                                                    (+1.-rx*rx)*ry*(+1.+ry)/2.*(+rz-1.)/2.+(+1.-rx*rx)*
                                                                    ry*(+1.+ry)/2.*rz*(+1.)/2.)*y[11]+(+rx*(+1.+rx)/2.*ry*
                                                                            (+1.+ry)/2.*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.+ry)/
                                                                            2.*rz*(+1.)/2.)*y[3]+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*
                                                                                    (-2.*rz))*y[13]+(+(+1.-rx*rx)*ry*(+ry-1.)/2.*(-2.*rz))*y[22]
          +(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(-2.*rz))*y[14]+(+rx*
                  (+rx-1.)/2.*(+1.-ry*ry)*(-2.*rz))*y[25]+(+(+1.-rx*rx)*
                          (+1.-ry*ry)*(-2.*rz))*y[27]+(+rx*(+1.+rx)/2.*(+1.-ry*ry
                                                                       )*(-2.*rz))*y[23]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(-
                                                                               2.*rz))*y[16]+(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(-2.*rz))*y[24]
          +(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(-2.*rz))*y[15]+(+rx*
                  (+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.+rz)/2.+rx*(+rx-1.)/
                  2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*y[5]+(+(+1.-rx*rx)*ry*
                          (+ry-1.)/2.*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+ry-1.)/2.*
                          rz*(+1.)/2.)*y[17]+(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(+
                                  1.+rz)/2.+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*y[6]
          +(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+1.+rz)/2.+rx*(+rx-1.)/
            2.*(+1.-ry*ry)*rz*(+1.)/2.)*y[20]+(+(+1.-rx*rx)*(+1.-
                    ry*ry)*(+1.+rz)/2.+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+1.)/
                    2.)*y[26]+(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.+rz)/2.+rx*
                               (+1.+rx)/2.*(+1.-ry*ry)*rz*(+1.)/2.)*y[18]+(+rx*(+rx-
                                       1.)/2.*ry*(+1.+ry)/2.*(+1.+rz)/2.+rx*(+rx-1.)/2.*ry*
                                       (+1.+ry)/2.*rz*(+1.)/2.)*y[8]+(+(+1.-rx*rx)*ry*(+1.+
                                               ry)/2.*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.+ry)/2.*rz*(+
                                                       1.)/2.)*y[19]+(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.+rz)/
                                                               2.+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.)/2.)*y[7];

    rc[8]=+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*(+rz-1.)/
            2.+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*z[1]+(+
                    (+1.-rx*rx)*ry*(+ry-1.)/2.*(+rz-1.)/2.+(+1.-rx*rx)*
                    ry*(+ry-1.)/2.*rz*(+1.)/2.)*z[9]+(+rx*(+1.+rx)/2.*ry*
                            (+ry-1.)/2.*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+ry-1.)/
                            2.*rz*(+1.)/2.)*z[2]+(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+
                                    rz-1.)/2.+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+1.)/2.)*z[12]
          +(+(+1.-rx*rx)*(+1.-ry*ry)*(+rz-1.)/2.+(+1.-rx*rx)*
            (+1.-ry*ry)*rz*(+1.)/2.)*z[21]+(+rx*(+1.+rx)/2.*(+1.-
                                            ry*ry)*(+rz-1.)/2.+rx*(+1.+rx)/2.*(+1.-ry*ry)*rz*(+
                                                    1.)/2.)*z[10]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+rz-1.)/
                                                            2.+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+1.)/2.)*z[4]+(+
                                                                    (+1.-rx*rx)*ry*(+1.+ry)/2.*(+rz-1.)/2.+(+1.-rx*rx)*
                                                                    ry*(+1.+ry)/2.*rz*(+1.)/2.)*z[11]+(+rx*(+1.+rx)/2.*ry*
                                                                            (+1.+ry)/2.*(+rz-1.)/2.+rx*(+1.+rx)/2.*ry*(+1.+ry)/
                                                                            2.*rz*(+1.)/2.)*z[3]+(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*
                                                                                    (-2.*rz))*z[13]+(+(+1.-rx*rx)*ry*(+ry-1.)/2.*(-2.*rz))*z[22]
          +(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(-2.*rz))*z[14]+(+rx*
                  (+rx-1.)/2.*(+1.-ry*ry)*(-2.*rz))*z[25]+(+(+1.-rx*rx)*
                          (+1.-ry*ry)*(-2.*rz))*z[27]+(+rx*(+1.+rx)/2.*(+1.-ry*ry
                                                                       )*(-2.*rz))*z[23]+(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(-
                                                                               2.*rz))*z[16]+(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(-2.*rz))*z[24]
          +(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(-2.*rz))*z[15]+(+rx*
                  (+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.+rz)/2.+rx*(+rx-1.)/
                  2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*z[5]+(+(+1.-rx*rx)*ry*
                          (+ry-1.)/2.*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+ry-1.)/2.*
                          rz*(+1.)/2.)*z[17]+(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(+
                                  1.+rz)/2.+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+1.)/2.)*z[6]
          +(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+1.+rz)/2.+rx*(+rx-1.)/
            2.*(+1.-ry*ry)*rz*(+1.)/2.)*z[20]+(+(+1.-rx*rx)*(+1.-
                    ry*ry)*(+1.+rz)/2.+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+1.)/
                    2.)*z[26]+(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.+rz)/2.+rx*
                               (+1.+rx)/2.*(+1.-ry*ry)*rz*(+1.)/2.)*z[18]+(+rx*(+rx-
                                       1.)/2.*ry*(+1.+ry)/2.*(+1.+rz)/2.+rx*(+rx-1.)/2.*ry*
                                       (+1.+ry)/2.*rz*(+1.)/2.)*z[8]+(+(+1.-rx*rx)*ry*(+1.+
                                               ry)/2.*(+1.+rz)/2.+(+1.-rx*rx)*ry*(+1.+ry)/2.*rz*(+
                                                       1.)/2.)*z[19]+(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.+rz)/
                                                               2.+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.)/2.)*z[7];

    return;
}

void w4(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double fw4(double *,int);
    double (*shap)(double *,int)=&fw4;
    dcoor(shap,refc,coor,rc,3,3,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double fw4(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,ry,rz,fval;
    double x[5],y[5],z[5];
    int j;
    for (j=1; j<=4; ++j)
    {
        x[j]=coorr[(1-1)*4+j-1];
        y[j]=coorr[(2-1)*4+j-1];
        z[j]=coorr[(3-1)*4+j-1];
    }
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    switch (n)
    {
    case 1:
        fval=
            +(+rx)*x[1]+(+ry)*x[2]+(+rz)*x[3]+(+(+1.-rx-
                                               ry-rz))*x[4];
        break;
    case 2:
        fval=
            +(+rx)*y[1]+(+ry)*y[2]+(+rz)*y[3]+(+(+1.-rx-
                                               ry-rz))*y[4];
        break;
    case 3:
        fval=
            +(+rx)*z[1]+(+ry)*z[2]+(+rz)*z[3]+(+(+1.-rx-
                                               ry-rz))*z[4];
        break;
        //default:
    }
    return fval;
}

void w10(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double fw10(double *,int);
    double (*shap)(double *,int)=&fw10;
    dcoor(shap,refc,coor,rc,3,3,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double fw10(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,ry,rz,fval;
    double x[11],y[11],z[11];
    int j;
    for (j=1; j<=10; ++j)
    {
        x[j]=coorr[(1-1)*10+j-1];
        y[j]=coorr[(2-1)*10+j-1];
        z[j]=coorr[(3-1)*10+j-1];
    }
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    switch (n)
    {
    case 1:
        fval=
            +(+rx*(+2.*rx-1.))*x[1]+(+rx*ry*4.)*x[5]+(+
                    ry*(+2.*ry-1.))*x[2]+(+ry*rz*4.)*x[6]+(+rz*(+2.*rz-1.))*x[3]
            +(+rx*rz*4.)*x[7]+(+rx*(+1.-rx-ry-rz)*4.)*x[8]+(+ry*(+
                    1.-rx-ry-rz)*4.)*x[9]+(+rz*(+1.-rx-ry-rz)*4.)*x[10]+(+
                            (+1.-2.*rx-2.*ry-2.*rz)*(+1.-rx-ry-rz))*x[4];
        break;
    case 2:
        fval=
            +(+rx*(+2.*rx-1.))*y[1]+(+rx*ry*4.)*y[5]+(+
                    ry*(+2.*ry-1.))*y[2]+(+ry*rz*4.)*y[6]+(+rz*(+2.*rz-1.))*y[3]
            +(+rx*rz*4.)*y[7]+(+rx*(+1.-rx-ry-rz)*4.)*y[8]+(+ry*(+
                    1.-rx-ry-rz)*4.)*y[9]+(+rz*(+1.-rx-ry-rz)*4.)*y[10]+(+
                            (+1.-2.*rx-2.*ry-2.*rz)*(+1.-rx-ry-rz))*y[4];
        break;
    case 3:
        fval=
            +(+rx*(+2.*rx-1.))*z[1]+(+rx*ry*4.)*z[5]+(+
                    ry*(+2.*ry-1.))*z[2]+(+ry*rz*4.)*z[6]+(+rz*(+2.*rz-1.))*z[3]
            +(+rx*rz*4.)*z[7]+(+rx*(+1.-rx-ry-rz)*4.)*z[8]+(+ry*(+
                    1.-rx-ry-rz)*4.)*z[9]+(+rz*(+1.-rx-ry-rz)*4.)*z[10]+(+
                            (+1.-2.*rx-2.*ry-2.*rz)*(+1.-rx-ry-rz))*z[4];
        break;
        //default:
    }
    return fval;
}

void w6(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double fw6(double *,int);
    double (*shap)(double *,int)=&fw6;
    dcoor(shap,refc,coor,rc,3,3,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double fw6(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,ry,rz,fval;
    double x[7],y[7],z[7];
    int j;
    for (j=1; j<=6; ++j)
    {
        x[j]=coorr[(1-1)*6+j-1];
        y[j]=coorr[(2-1)*6+j-1];
        z[j]=coorr[(3-1)*6+j-1];
    }
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    switch (n)
    {
    case 1:
        fval=
            +(+rx*(+1.-rz)/2.)*x[1]+(+ry*(+1.-rz)/2.)*x[2]
            +(+(+1.-rx-ry)*(+1.-rz)/2.)*x[3]+(+rx*(+1.+rz)/2.)*x[4]
            +(+ry*(+1.+rz)/2.)*x[5]+(+(+1.-rx-ry)*(+1.+rz)/2.)*x[6];
        break;
    case 2:
        fval=
            +(+rx*(+1.-rz)/2.)*y[1]+(+ry*(+1.-rz)/2.)*y[2]
            +(+(+1.-rx-ry)*(+1.-rz)/2.)*y[3]+(+rx*(+1.+rz)/2.)*y[4]
            +(+ry*(+1.+rz)/2.)*y[5]+(+(+1.-rx-ry)*(+1.+rz)/2.)*y[6];
        break;
    case 3:
        fval=
            +(+rx*(+1.-rz)/2.)*z[1]+(+ry*(+1.-rz)/2.)*z[2]
            +(+(+1.-rx-ry)*(+1.-rz)/2.)*z[3]+(+rx*(+1.+rz)/2.)*z[4]
            +(+ry*(+1.+rz)/2.)*z[5]+(+(+1.-rx-ry)*(+1.+rz)/2.)*z[6];
        break;
        //default:
    }
    return fval;
}

void l2(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double fl2(double *,int);
    double (*shap)(double *,int)=&fl2;
    dcoor(shap,refc,coor,rc,1,1,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double fl2(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,fval;
    double x[3];
    int j;
    for (j=1; j<=2; ++j)
    {
        x[j]=coorr[(1-1)*2+j-1];
    }
    rx=refc[1];
    switch (n)
    {
    case 1:
        fval=
            +(+(+1.-rx)/2.)*x[1]+(+(+1.+rx)/2.)*x[2];
        break;
        //default:
    }
    return fval;
}

void l3(double *refc,double *coor,double *rc)
/* compute coordinate value and jacobi's matrix rc
 by reference coordinate value */
{
    extern double fl3(double *,int);
    double (*shap)(double *,int)=&fl3;
    dcoor(shap,refc,coor,rc,1,1,1);
    /* coordinate value and their partial derivatives caculation
     compute partial derivatives by centered difference
     which is in the file ccshap.for of felac library */
    return;
}

double fl3(double *refc,int n)
/* coordinate transfer function caculation */
{
    double rx,fval;
    double x[4];
    int j;
    for (j=1; j<=3; ++j)
    {
        x[j]=coorr[(1-1)*3+j-1];
    }
    rx=refc[1];
    switch (n)
    {
    case 1:
        fval=
            +(+rx*(+rx-1.)/2.)*x[1]+(+(+1.-rx*rx))*x[3]
            +(+rx*(+1.+rx)/2.)*x[2];
        break;
        //default:
    }
    return fval;
}

void dq4(double *refc,double *d)
{
    double rx,ry;
    rx=refc[1];
    ry=refc[2];

    d[1]=(+1.-rx)/2.*(+1.-ry)/2.;
    d[2]=(+1.+rx)/2.*(+1.-ry)/2.;
    d[3]=(+1.+rx)/2.*(+1.+ry)/2.;
    d[4]=(+1.-rx)/2.*(+1.+ry)/2.;
    return;
}


void dt3(double *refc,double *d)
{
    double rx,ry;
    rx=refc[1];
    ry=refc[2];
    d[1]=rx;
    d[2]=ry;
    d[3]=1.-rx-ry;
    return;
}

void dt6(double *refc,double *d)
{
    double rx,ry;
    rx=refc[1];
    ry=refc[2];
    d[1]=rx*(+2.*rx-1.);
    d[4]=(+rx*ry*4.);
    d[2]=ry*(+2.*ry-1.);
    d[5]=(+ry*(+1.-rx-ry)*4.);
    d[3]=(+(+1.-2.*rx-2.*ry)*(+1.-rx-ry));
    d[6]=(+rx*(+1.-rx-ry)*4.);
    return;
}


void dq9(double *refc,double *d)
{
    double rx,ry;
    rx=refc[1];
    ry=refc[2];
    d[1]=(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.);
    d[5]=(+(+1.-rx*rx)*ry*(+ry-1.)/2.);
    d[2]=(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.);
    d[8]=(+rx*(+rx-1.)/2.*(+1.-ry*ry));
    d[9]=(+(+1.-rx*rx)*(+1.-ry*ry));
    d[6]=(+rx*(+1.+rx)/2.*(+1.-ry*ry));
    d[4]=(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.);
    d[7]=(+(+1.-rx*rx)*ry*(+1.+ry)/2.);
    d[3]=(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.);
    return;
}

void dc8(double *refc,double *d)
{
    double rx,ry,rz;
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    d[1]=(+(+1.-rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.);
    d[2]=(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.-rz)/2.);
    d[3]=(+(+1.+rx)/2.*(+1.+ry)/2.*(+1.-rz)/2.);
    d[4]=(+(+1.-rx)/2.*(+1.+ry)/2.*(+1.-rz)/2.);
    d[5]=(+(+1.-rx)/2.*(+1.-ry)/2.*(+1.+rz)/2.);
    d[6]=(+(+1.+rx)/2.*(+1.-ry)/2.*(+1.+rz)/2.);
    d[7]=(+(+1.+rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.);
    d[8]=(+(+1.-rx)/2.*(+1.+ry)/2.*(+1.+rz)/2.);
    return;
}

void dc27(double *refc,double *d)
{
    double rx,ry,rz;
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    d[1]=(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.);
    d[9]=(+(+1.-rx*rx)*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.);
    d[2]=(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+rz-1.)/2.);
    d[12]=(+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.);
    d[21]=(+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+rz-1.)/2.);
    d[10]=(+rx*(+1.+rx)/2.*(+1.-ry*ry)*rz*(+rz-1.)/2.);
    d[4]=(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.);
    d[11]=(+(+1.-rx*rx*ry*(+1.+ry)/2.*rz*(+rz-1.))/2.);
    d[3]=(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+rz-1.)/2.);
    d[13]=(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz));
    d[22]=(+(+1.-rx*rx)*ry*(+ry-1.)/2.*(+1.-rz*rz));
    d[14]=(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*(+1.-rz*rz));
    d[25]=(+rx*(+rx-1.)/2.*(+1.-ry*ry)*(+1.-rz*rz));
    d[27]=(+(+1.-rx*rx)*(+1.-ry*ry)*(+1.-rz*rz));
    d[23]=(+rx*(+1.+rx)/2.*(+1.-ry*ry)*(+1.-rz*rz));
    d[16]=(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz));
    d[24]=(+(+1.-rx*rx)*ry*(+1.+ry)/2.*(+1.-rz*rz));
    d[15]=(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*(+1.-rz*rz));
    d[5]=(+rx*(+rx-1.)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.);
    d[17]=(+(+1.-rx*rx)*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.);
    d[6]=(+rx*(+1.+rx)/2.*ry*(+ry-1.)/2.*rz*(+1.+rz)/2.);
    d[20]=(+rx*(+rx-1.)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.);
    d[26]=(+(+1.-rx*rx)*(+1.-ry*ry)*rz*(+1.+rz)/2.);
    d[18]=(+rx*(+1.+rx)/2.*(+1.-ry*ry)*rz*(+1.+rz)/2.);
    d[8]=(+rx*(+rx-1.)/2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.);
    d[19]=(+(+1.-rx*rx)*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.);
    d[7]=(+rx*(+1.+rx)/2.*ry*(+1.+ry)/2.*rz*(+1.+rz)/2.);
    return;
}


void dw4(double *refc,double *d)
{
    double rx,ry,rz;
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    d[1]=(+rx);
    d[2]=(+ry);
    d[3]=(+rz);
    d[4]=(+(+1.-rx-ry-rz));
    return;
}

void dw10(double *refc,double *d)
{
    double rx,ry,rz;
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    d[1]=(+rx*(+2.*rx-1.));
    d[5]=(+rx*ry*4.);
    d[2]=(+ry*(+2.*ry-1.));
    d[6]=(+ry*rz*4.);
    d[3]=(+rz*(+2.*rz-1.));
    d[7]=(+rx*rz*4.);
    d[8]=(+rx*(+1.-rx-ry-rz)*4.);
    d[9]=(+ry*(+1.-rx-ry-rz)*4.);
    d[10]=(+rz*(+1.-rx-ry-rz)*4.);
    d[4]=(+(+1.-2.*rx-2.*ry-2.*rz)*(+1.-rx-ry-rz));

    return;
}


void dw6(double *refc,double *d)
{
    double rx,ry,rz;
    rx=refc[1];
    ry=refc[2];
    rz=refc[3];
    d[1]=(+rx*(+1.-rz)/2.);
    d[2]=(+ry*(+1.-rz)/2.);
    d[3]=(+(+1.-rx-ry)*(+1.-rz)/2.);
    d[4]=(+rx*(+1.+rz)/2.);
    d[5]=(+ry*(+1.+rz)/2.);
    d[6]=(+(+1.-rx-ry)*(+1.+rz)/2.);
    return;
}


void dl2(double *refc,double *d)
{
    double rx;
    rx=refc[1];
    d[1]=+(+(+1.-rx)/2.);
    d[2]=(+(+1.+rx)/2.);
    return;
}

void dl3(double *refc,double *d)
{
    double rx;
    rx=refc[1];
    d[1]=+(+rx*(+rx-1.)/2.);
    d[3]=(+(+1.-rx*rx));
    d[2]=(+rx*(+1.+rx)/2.);
    return;
}
